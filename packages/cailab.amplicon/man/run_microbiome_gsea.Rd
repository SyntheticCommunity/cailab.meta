% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gsea.R
\name{run_microbiome_gsea}
\alias{run_microbiome_gsea}
\title{执行微生物群落样本级富集分析 (Sample-Level Enrichment Analysis)}
\usage{
run_microbiome_gsea(
  ps,
  target_taxon,
  tax_rank,
  sample_feat,
  nperm = 1000,
  min_size = 5,
  max_size = 500
)
}
\arguments{
\item{ps}{A \code{phyloseq} object.}

\item{target_taxon}{A character string. The target taxon name (e.g., "Escherichia").}

\item{tax_rank}{A character string. The rank of the target taxon (e.g., "Genus").}

\item{sample_feat}{A character string. The metadata column name to group samples (e.g., "Group").}

\item{nperm}{Integer. Number of permutations for fgsea. Default is 1000.}

\item{min_size}{Integer. Minimum size of a feature set. Default is 5.}

\item{max_size}{Integer. Maximum size of a feature set. Default is 500.}
}
\value{
A \code{data.frame} (tbl_df) containing the GSEA results.
Columns include: pathway, pval, padj, NES, size, leadingEdge.
}
\description{
该函数接受 phyloseq 对象，针对特定的目标微生物，分析样本元数据特征是否在
该微生物高丰度或低丰度的样本中富集。
}
\examples{
\dontrun{
# Suppose there is a ps object.
res <- run_microbiome_gsea(
    ps = ps,
    target_taxon = "Bacillus",
    tax_rank = "Genus",
    sample_feat = "SampleType"
)
print(res)
}
}
